<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Menalmei • Painel do Investidor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
    --gold:#d4af37;
    --dark:#0b0b0b;
    --card:#151515;
    --border:#2a2a2a;
    --muted:#9a9a9a;
}

body{
    margin:0;
    background:radial-gradient(circle at top,#1a1a1a,#000);
    font-family:Arial,Helvetica,sans-serif;
    color:#fff;
}

.login{
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
}

.login-box{
    background:var(--card);
    padding:35px;
    border-radius:20px;
    border:1px solid var(--border);
    width:320px;
    text-align:center;
}

.login-box img{
    width:120px;
    margin-bottom:15px;
}

.login-box input{
    width:100%;
    padding:10px;
    border-radius:10px;
    border:none;
    margin-top:10px;
}

.login-box button{
    width:100%;
    padding:12px;
    border:none;
    border-radius:12px;
    background:var(--gold);
    font-weight:bold;
    margin-top:15px;
    cursor:pointer;
}

.erro{
    color:#ff6b6b;
    font-size:13px;
    margin-top:10px;
}

.painel{ display:none; }

header{
    text-align:center;
    padding:25px;
}

header img{ width:130px; }

.card{
    background:linear-gradient(180deg,#141414,#0a0a0a);
    border:1px solid var(--border);
    border-radius:20px;
    max-width:1100px;
    margin:20px auto;
    padding:30px;
}

.grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
    gap:18px;
}

.item{
    background:var(--card);
    border:1px solid var(--border);
    padding:18px;
    border-radius:14px;
}

.item span{
    font-size:13px;
    color:var(--muted);
}

.item strong{
    display:block;
    margin-top:6px;
    font-size:20px;
}

.progress-bar{
    margin-top:20px;
    height:14px;
    background:#1f1f1f;
    border-radius:20px;
    overflow:hidden;
}

.progress{
    height:100%;
    background:linear-gradient(90deg,#a8872f,var(--gold));
    width:0%;
}

.cards-investidor{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
    gap:18px;
    margin-top:30px;
}

.cards-investidor .item strong{
    font-size:22px;
    color:var(--gold);
}
</style>
</head>

<body>

<div class="login" id="login">
    <div class="login-box">
        <img src="logotipo.png">
        <input id="cpf" placeholder="CPF (somente números)">
        <input id="senha" type="password" placeholder="Senha">
        <button onclick="entrar()">Entrar</button>
        <div class="erro" id="erro"></div>
    </div>
</div>

<div class="painel" id="painel">
<header>
    <img src="logotipo.png">
    <h3 id="nomeUsuario"></h3>
</header>

<section class="card">
<h2 id="nomeInv"></h2>

<div class="grid">
    <div class="item">
        <span>Valor da Ação</span>
        <strong id="valorAcao"></strong>
    </div>

    <div class="item">
        <span>Disponível para Investir</span>
        <strong id="disponivel"></strong>
    </div>

    <div class="item">
        <span>Retorno da Ação</span>
        <strong id="retornoAcao"></strong>
    </div>

    <div class="item">
        <span>Início do investimento</span>
        <strong id="inicio"></strong>
    </div>

    <div class="item">
        <span>Término do investimento</span>
        <strong id="termino"></strong>
    </div>
</div>

<div class="progress-bar">
    <div class="progress" id="barra"></div>
</div>

<div class="cards-investidor">
    <div class="item">
        <span>Total Investido</span>
        <strong id="totalInvestido"></strong>
    </div>

    <div class="item">
        <span>Total Recebido</span>
        <strong id="totalRecebido"></strong>
    </div>
</div>

<button style="margin-top:25px" onclick="toggleHistorico()">Histórico de Recebimento</button>

<div id="historico" style="display:none;margin-top:20px;">
<table width="100%" cellpadding="10" style="border-collapse:collapse;">
<thead>
<tr style="background:#1c1c1c">
<th>Transação</th>
<th>Recebido (R$)</th>
<th>Data</th>
<th>Hora</th>
</tr>
</thead>
<tbody id="tabelaHistorico"></tbody>
</table>
</div>

</section>
</div>

<script>
const URL = "https://script.google.com/macros/s/AKfycbyZzTseojQuHIdgciBQLtTgM-NadofDOTyOeJBJ-N4Hnbf2YSDgv4U7B5yc8O9VRdQ/exec";
let timer = null;

function entrar(){
    fetch(`${URL}?cpf=${cpf.value}&senha=${senha.value}`)
    .then(r=>r.json())
    .then(d=>{
        if(d.erro){
            erro.innerText = d.erro;
            return;
        }

        login.style.display="none";
        painel.style.display="block";

        atualizarPainel(d);

        timer = setInterval(()=>{
            fetch(`${URL}?cpf=${cpf.value}&senha=${senha.value}`)
            .then(r=>r.json())
            .then(atualizarPainel);
        },5000);
    });
}

function atualizarPainel(d){
    nomeUsuario.innerText = "Olá, " + d.usuario.nome;
    nomeInv.innerText = d.investimento.NOME;

    valorAcao.innerText = "R$ " + d.investimento["VALOR ACAO"];
    disponivel.innerText = "R$ " + d.investimento["DISPONIVEL"];
    retornoAcao.innerText = d.investimento["RETORNO ACAO"] + "%";

    inicio.innerText = d.investimento.INICIO;
    termino.innerText = d.investimento.TERMINO;

    barra.style.width = d.investimento["PERCENTUAL VENDIDO"] + "%";

    totalInvestido.innerText =
      "R$ " + d.usuario.investimento.toFixed(2);

    totalRecebido.innerText =
      "R$ " + d.totalRecebido.toFixed(2);

    tabelaHistorico.innerHTML="";
    d.historico.forEach(h=>{
        tabelaHistorico.innerHTML+=`
        <tr>
            <td>${h.transacao}</td>
            <td>R$ ${h.recebido.toFixed(2)}</td>
            <td>${h.data}</td>
            <td>${h.hora}</td>
        </tr>`;
    });
}

function toggleHistorico(){
    historico.style.display =
      historico.style.display==="none"?"block":"none";
}
</script>

</body>
</html>
